<!DOCTYPE html>
<html>
<head>
    <title>KinderBrain</title>
    <!-- Link to styles in main.css in the public folder  -->
    <link rel="stylesheet" href="/main.css">
    <link rel="stylesheet" href="/games.css">
    <!-- Link to the Bootstrap CSS for styling the page -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
    crossorigin="anonymous">
    <!-- Link to the Font Awesome CSS for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <!-- Bootstrap JavaScript libraries -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
</head>

<body class="games-page">
    <!-- Include the header -->
    <%- include('../utils/header') %>

    <div class="gamescontainer">
        <div class="headerSection">
            <h1>THE GAMES <br> FUN FOR YOUR MIND</h1>
             <button class="btn btn-primary" onclick="location.href='/dashboard'">Login to view your dashboard</button>
        </div>

        <h2 class="text-center my-4">Top Games Of The Month</h2>
        <div id="topGamesCarousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card">
                                <img src="path/to/game1.png" class="card-img-top" alt="Game 1">
                                <div class="card-body">
                                    <h5 class="card-title">Game Title 1</h5>
                                    <p class="card-text">Progress bar</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="path/to/game2.png" class="card-img-top" alt="Game 2">
                                <div class="card-body">
                                    <h5 class="card-title">Game Title 2</h5>
                                    <p class="card-text">Progress bar</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="path/to/game3.png" class="card-img-top" alt="Game 3">
                                <div class="card-body">
                                    <h5 class="card-title">Game Title 3</h5>
                                    <p class="card-text">Progress bar</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="path/to/game4.png" class="card-img-top" alt="Game 4">
                                <div class="card-body">
                                    <h5 class="card-title">Game Title 4</h5>
                                    <p class="card-text">Progress bar</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="carousel-item">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card">
                                <img src="path/to/game5.png" class="card-img-top" alt="Game 5">
                                <div class="card-body">
                                    <h5 class="card-title">Game Title 5</h5>
                                    <p class="card-text">Progress bar</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <img src="path/to/game6.png" class="card-img-top" alt="Game 6">
                                <div class="card-body">
                                    <h5 class="card-title">Game Title 6</h5>
                                    <p class="card-text">Progress bar</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <a class="carousel-control-prev" href="#topGamesCarousel" role="button" data-slide="prev">
                <i class="fas fa-chevron-left carousel-control-prev-icon" aria-hidden="true"></i>
            </a>
            <a class="carousel-control-next" href="#topGamesCarousel" role="button" data-slide="next">
                <i class="fas fa-chevron-right carousel-control-next-icon" aria-hidden="true"></i>
            </a>
        </div>

        <div class="podium-container">
            <h2>Top Players Of The Month</h2>
            <div class="podium">
                <div class="podium-item second-place">
                    <div class="star">
                        <i class="fas fa-star"></i>
                        <img src="path/to/profile2.png" alt="Player 2">
                    </div>
                    <div class="podium-number">2</div>
                </div>
                <div class="podium-item first-place">
                    <div class="star">
                        <i class="fas fa-star"></i>
                        <img src="/images/login.png" alt="Player 1">
                    </div>
                    <div class="podium-number">1</div>
                </div>
                <div class="podium-item third-place">
                    <div class="star">
                        <i class="fas fa-star"></i>
                        <img src="" alt="Player 3">
                    </div>
                    <div class="podium-number">3</div>
                </div>
            </div>
        </div>
        
        <div class="gamesBreif">
            <h3>THE GAMES FUN FOR YOUR MIND</h3>
            <p class="gamesDescription">
                For your mental health, indulge in a world of games. Play these games to relax as well as learn something new. Our carefully curated selection of games not only provides entertainment but also helps in cognitive development, improves problem-solving skills, and enhances memory. Whether you are looking for a fun break or a challenging puzzle, our games offer a perfect balance to stimulate your mind and keep you engaged. Explore different categories and find the ones that suit your interests and skill level. Remember, a healthy mind is just a game away!
            </p>
            
        </div>

        <div class="text-center my-4">
            <select id="categoryDropdown" class="form-control" onchange="filterGamesByCategory()">
                <option value="all">All Categories</option>
                <option value="easy">Easy</option>
                <option value="medium">Medium</option>
                <option value="difficult">Difficult</option>
            </select>
        </div>

        <div id="gamesSections">
            <h2 class="game-header">Mind Games</h2>
            <div id="mindGamesCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <!-- Carousel items -->
                </div>
                <a class="carousel-control-prev" href="#mindGamesCarousel" role="button" data-slide="prev">
                    <i class="fas fa-chevron-left carousel-control-prev-icon" aria-hidden="true"></i>
                </a>
                <a class="carousel-control-next" href="#mindGamesCarousel" role="button" data-slide="next">
                    <i class="fas fa-chevron-right carousel-control-next-icon" aria-hidden="true"></i>
                </a>
            </div>

            <h2 class="game-header">Relaxation Games</h2>
            <div id="relaxationGamesCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <!-- Carousel items -->
                </div>
                <a class="carousel-control-prev" href="#relaxationGamesCarousel" role="button" data-slide="prev">
                    <i class="fas fa-chevron-left carousel-control-prev-icon" aria-hidden="true"></i>
                </a>
                <a class="carousel-control-next" href="#relaxationGamesCarousel" role="button" data-slide="next">
                    <i class="fas fa-chevron-right carousel-control-next-icon" aria-hidden="true"></i>
                </a>
            </div>

            <h2 class="game-header">Educational Games</h2>
            <div id="educationalGamesCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <!-- Carousel items -->
                </div>
                <a class="carousel-control-prev" href="#educationalGamesCarousel" role="button" data-slide="prev">
                    <i class="fas fa-chevron-left carousel-control-prev-icon" aria-hidden="true"></i>
                </a>
                <a class="carousel-control-next" href="#educationalGamesCarousel" role="button" data-slide="next">
                    <i class="fas fa-chevron-right carousel-control-next-icon" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- Include the footer -->
    <%- include('../utils/footer') %>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadGames('all');

            document.getElementById('categoryDropdown').addEventListener('change', function() {
                const selectedCategory = this.value;
                loadGames(selectedCategory);
            });
        });

        function loadGames(category) {
            fetch(`/games/category/${category}`)
                .then(response => response.json())
                .then(data => {
                    const sections = ['mind', 'relaxation', 'educational'];
                    sections.forEach(section => {
                        const gamesContainer = document.querySelector(`#${section}GamesCarousel .carousel-inner`);
                        gamesContainer.innerHTML = '';
                        let row = null;
                        let filteredGames = data.filter(game => game.section === section && game.id <= 18);

                        let gamesToShow = [...filteredGames, ...filteredGames];

                        gamesToShow.forEach((game, index) => {
                            if (index % 4 === 0) {
                                row = document.createElement('div');
                                row.className = 'row';
                                let carouselItem = document.createElement('div');
                                carouselItem.className = 'carousel-item';
                                if (index === 0) {
                                    carouselItem.classList.add('active');
                                }
                                carouselItem.appendChild(row);
                                gamesContainer.appendChild(carouselItem);
                            }
                            let col = document.createElement('div');
                            col.className = 'col-md-3';
                            const userId = '<%= userName %>';
                            const elapsedMinutes = parseFloat(localStorage.getItem(`elapsedMinutes_${game.id}_${userId}`)) || 0;
                            const roundedElapsedMinutes = elapsedMinutes.toFixed(2);
                            const progressPercentage = (elapsedMinutes / 15) * 100;
                            col.innerHTML = `
                            <div class="card" onclick="window.location.href='/games/play/${game.id}'">
                                <img src="${game.image}" class="card-img-top" alt="${game.title}">
                                <div class="card-body">
                                    <h5 class="card-title">${game.title}</h5>
                                    <p class="card-text">${game.description}</p>
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar" style="width: ${progressPercentage}%;"
                                            aria-valuenow="${progressPercentage}" aria-valuemin="0" aria-valuemax="100">
                                            ${roundedElapsedMinutes} minutes played
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                            row.appendChild(col);
                        });
                    });
                })
                .catch(error => console.error('Error fetching games:', error));
        }
    </script>
    
    
    
</body>
</html>
